<div class="container">
  <div class="page-header">
    <h1>📋 Ventas</h1>
    <p>Gestiona las ventas de tu tienda</p>
    <button (click)="router.navigate(['/orders/create'])" class="btn btn-primary">
      ➕ Nueva Venta
    </button>
  </div>

  <!-- Estadísticas -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">💰</div>
      <div class="stat-content">
        <h3>Total Ventas</h3>
        <p class="stat-value">${{ totalSales | number }}</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">📦</div>
      <div class="stat-content">
        <h3>Órdenes</h3>
        <p class="stat-value">{{ orders.length }}</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">✅</div>
      <div class="stat-content">
        <h3>Completadas</h3>
        <p class="stat-value">{{ completedOrders }}</p>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">⏳</div>
      <div class="stat-content">
        <h3>Pendientes</h3>
        <p class="stat-value">{{ pendingOrders }}</p>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Cargando ventas...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-error">
    {{ error }}
  </div>

  <!-- Lista de órdenes -->
  <div *ngIf="!loading && !error" class="orders-container">
    <div *ngFor="let order of orders" class="order-card">
      <div class="order-header">
        <div class="order-info">
          <h3>Venta #{{ order.id }}</h3>
          <p class="order-date">{{ order.createdAt | date:'dd/MM/yyyy HH:mm' }}</p>
        </div>
        
        <div class="order-status">
          <span class="status-badge" [class]="getStatusClass(order.payment?.status?.status)">
            {{ order.payment?.status?.status || 'Sin estado' }}
          </span>
        </div>
      </div>

      <div class="order-details">
        <div class="customer-info">
          <h4>Cliente</h4>
          <p>{{ order.user.people.name }} {{ order.user.people.lastname }}</p>
          <p class="customer-dni">DNI: {{ order.user.people.dni }}</p>
        </div>

        <div class="payment-info">
          <h4>Pago</h4>
          <p>{{ order.payment?.method?.method || 'No especificado' }}</p>
          <p class="payment-status">{{ order.payment?.status?.status || 'Sin estado' }}</p>
        </div>

        <div class="order-total">
          <h4>Total</h4>
          <p class="total-amount">${{ order.total | number }}</p>
        </div>
      </div>

      <div class="order-actions">
        <a [routerLink]="['/orders', order.id]" class="btn btn-outline">
          👁️ Ver Detalles
        </a>
        
        <ng-container *ngIf="canEdit()">
          <button class="btn btn-outline">
            ✏️ Editar
          </button>
        </ng-container>
      </div>
    </div>
  </div>

  <!-- Sin órdenes -->
  <div *ngIf="!loading && !error && orders.length === 0" class="empty-state">
    <div class="empty-icon">📋</div>
    <h3>No hay ventas registradas</h3>
    <p>Crea tu primera venta para comenzar</p>
    <button (click)="router.navigate(['/orders/create'])" class="btn btn-primary">
      ➕ Crear Primera Venta
    </button>
  </div>
</div>
